(function(i){function p(a,b){function m(){b.width!=!1&&b.height!=!1?(c.height(b.height),c.width(b.width)):j!=!1&&(c.height(j.height()),c.width(j.width()));e={height:c.height(),width:c.width()}}var g=i('<div class="'+b.binderClass+'"></div>'),c=i('<div class="'+b.contentClass+'"></div>');g.css({position:"absolute",overflow:"hidden"});a.css({position:"relative",overflow:"hidden"});c.css({position:"absolute"});var j=!1;b.content==!1&&a.contents().length?j=a.contents().detach():b.content!=!1&&(j=b.content.detach());
c.append(j);g.append(c);a.append(g);var k=!0,l=!0,n=0,o=0,d={top:0,left:0},e={height:0,width:0},h={height:0,width:0};a.bind("dragstop",function(f,a){d.top!=a.position.top&&(k=!1);d.left!=a.position.left&&(l=!1);d.left=a.position.left;d.top=a.position.top});return{init:function(){m();var a=b.position.split(" ");if(a.indexOf("bottom")!=-1)l=!1,d.top=h.height-e.height;else if(a.indexOf("top")!=-1)l=!1,d.top=0;if(a.indexOf("right")!=-1)k=!1,d.left=h.width-e.width;else if(a.indexOf("left")!=-1)k=!1,d.left=
0},adjust:function(){h.height=a.height();h.width=a.width();var f;if(h.height>e.height)c.css("top",0),g.height(e.height),g.css("top",Math.floor(h.height/2)-Math.floor(e.height/2));else{f=e.height-h.height;g.height(h.height+f*2);g.css("top",-f);if(l)d.top=Math.floor(f/2),c.css("top",d.top);else{var b=d.top+(f-n);b=b>=0?b:0;d.top=b;c.css("top",b)}n=f}h.width>e.width?(c.css("left",0),g.width(e.width),g.css("left",Math.floor(h.width/2)-Math.floor(e.width/2))):(f=e.width-h.width,g.width(h.width+f*2),g.css("left",
-f),k?(d.left=Math.floor(f/2),c.css("left",d.left)):(b=d.left+(f-o),b=b>=0?b:0,d.left=b,c.css("left",b)),o=f)},updateContentSize:m,setContentHeight:function(a){if(a!=null)e.height=a,c.height(a)},setContentWidth:function(a){if(a!=null)e.width=a,c.width(a)},getContentSize:function(){return e},content:c,binder:g}}i.widget("ui.viewport",{options:{binderClass:"viewportBinder",contentClass:"viewportContent",position:"center",content:!1,height:!1,width:!1},_create:function(){var a=this.options.content,b=
typeof a=="object";if(b&&a.tagName!=null)this.options.content=i(a);else if(b&&i.isArray(a))this.options.content=i(a);this.viewport=p(this.element,this.options);this.viewport.init();this.viewport.adjust()},content:function(){return this.viewport.content},binder:function(){return this.viewport.binder},adjust:function(){this.viewport.adjust()},update:function(){this.viewport.updateContentSize();this.viewport.adjust()},size:function(a,b){if(a==null||b==null)return this.viewport.getContentSize();this.viewport.setContentHeight(a);
this.viewport.setContentWidth(b)},height:function(a){if(a==null)return this.viewport.getContentSize().height;this.viewport.setContentHeight(a)},width:function(a){if(a==null)return this.viewport.getContentSize().width;this.viewport.setContentWidth(a)}})})(jQuery);