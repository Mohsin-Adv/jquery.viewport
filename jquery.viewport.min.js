(function(h){function l(a){var b=typeof a=="object";if(b&&a.jquery!=null)return a;else if(b&&a.tagName!=null)return h(a);else if(b&&h.isArray(a))return h(a);else if(b&&a.content!=null)return l(a.content);return h.fn.viewport.defaults.content}function r(a,b){function g(){var c={height:a.height(),width:a.width()},e;if(c.height>j.height){d.css("top",0);f.height(j.height);f.css("top",Math.floor(c.height/2)-Math.floor(j.height/2))}else{e=j.height-c.height;f.height(c.height+e*2);f.css("top",-e);if(m){i.top=
Math.floor(e/2);d.css("top",i.top)}else{var k=i.top+(e-n);k=k>=0?k:0;d.css("top",k);i.top=k}n=e}if(c.width>j.width){d.css("left",0);f.width(j.width);f.css("left",Math.floor(c.width/2)-Math.floor(j.width/2))}else{e=j.width-c.width;f.width(c.width+e*2);f.css("left",-e);if(o){i.left=Math.floor(e/2);d.css("left",i.left)}else{c=i.left+(e-p);c=c>=0?c:0;d.css("left",c);i.left=c}p=e}}var f=h('<div class="'+b.binderClass+'"></div>'),d=h('<div class="'+b.contentClass+'"></div>');f.css({position:"absolute",
overflow:"hidden"});a.css({position:"relative",overflow:"hidden"});d.css({position:"absolute"});if(b.width!=false&&b.height!=false){d.height(b.height);d.width(b.width)}else if(b.content!=false){d.height(b.content.height());d.width(b.content.width())}b.content!=false?d.append(b.content.detach()):d.append(a.contents().detach());f.append(d);a.append(f);var i={left:d.offset().left,top:d.offset().top},j={height:d.height(),width:d.width()},o=true,m=true,n=0,p=0;a.bind("dragstop",function(c,e){if(i.top!=
e.position.top)o=false;if(i.left!=e.position.left)m=false;i.left=e.position.left;i.top=e.position.top});g();return{adjust:g,setContentHeight:function(c){if(c!=null){j.height=c;d.height(c)}},setContentWidth:function(c){if(c!=null){j.width=c;d.width(c)}},getContentSize:function(){return j},content:d,binder:f}}var q={content:function(){return this.content},binder:function(){return this.binder},update:function(){this.adjust()},size:function(a,b){if(a==null||b==null)return this.getContentSize();this.setContentHeight(a);
this.setContentWidth(b)},height:function(a){if(a==null)return this.getContentSize().height;this.setContentHeight(a)},width:function(a){if(a==null)return this.getContentSize().width;this.setContentWidth(a)}};h.fn.viewport=function(a){a=a||{};var b=this.eq(0),g=b.data("viewport");if(typeof a=="string"&&g&&h.isFunction(q[a])){var f=Array.prototype.slice.call(arguments,1);if(f=q[a].apply(g,f))return f}if(!g){g={content:l(a)};if(!h.isArray(a)&&a.tagName==null&&a.jquery==null)g=h.extend({},a,g);g=h.extend({},
h.fn.viewport.defaults,g);g=r(b,g);b.data("viewport",g)}return this};h.fn.viewport.defaults={binderClass:"viewportBinder",contentClass:"viewportContent",content:false,height:false,width:false}})(jQuery);