(function(i){function p(b,a){function l(){a.width!=!1&&a.height!=!1?(c.height(a.height),c.width(a.width)):j!=!1&&(c.height(j.height()),c.width(j.width()));e={height:c.height(),width:c.width()}}var f=i('<div class="'+a.binderClass+'"></div>'),c=i('<div class="'+a.contentClass+'"></div>');f.css({position:"absolute",overflow:"hidden"});b.css({position:"relative",overflow:"hidden"});c.css({position:"absolute"});var j=!1;a.content==!1&&b.contents().length?j=b.contents().detach():a.content!=!1&&(j=a.content.detach());
c.append(j);f.append(c);b.append(f);var m=!0,k=!0,n=0,o=0,d={top:0,left:0},e={height:0,width:0},h={height:0,width:0};b.bind("dragstop",function(b,c){d.top!=c.position.top&&(m=!1);d.left!=c.position.left&&(k=!1);d.left=c.position.left;d.top=c.position.top});return{init:function(){l();if(a.position.indexOf("bottom")!=-1)k=!1,d.top=h.height-e.height;else if(a.position.indexOf("top")!=-1)k=!1,d.top=0},adjust:function(){h.height=b.height();h.width=b.width();var g;if(h.height>e.height)c.css("top",0),f.height(e.height),
f.css("top",Math.floor(h.height/2)-Math.floor(e.height/2));else{g=e.height-h.height;f.height(h.height+g*2);f.css("top",-g);if(k)d.top=Math.floor(g/2),c.css("top",d.top);else{var a=d.top+(g-n);a=a>=0?a:0;d.top=a;c.css("top",a)}n=g}h.width>e.width?(c.css("left",0),f.width(e.width),f.css("left",Math.floor(h.width/2)-Math.floor(e.width/2))):(g=e.width-h.width,f.width(h.width+g*2),f.css("left",-g),m?(d.left=Math.floor(g/2),c.css("left",d.left)):(a=d.left+(g-o),a=a>=0?a:0,d.left=a,c.css("left",a)),o=g)},
updateContentSize:l,setContentHeight:function(a){if(a!=null)e.height=a,c.height(a)},setContentWidth:function(a){if(a!=null)e.width=a,c.width(a)},getContentSize:function(){return e},content:c,binder:f}}i.widget("ui.viewport",{options:{binderClass:"viewportBinder",contentClass:"viewportContent",position:"center",content:!1,height:!1,width:!1},_create:function(){var b=this.options.content,a=typeof b=="object";if(a&&b.tagName!=null)this.options.content=i(b);else if(a&&i.isArray(b))this.options.content=
i(b);this.viewport=p(this.element,this.options);this.viewport.init();this.viewport.adjust()},content:function(){return this.viewport.content},binder:function(){return this.viewport.binder},adjust:function(){this.viewport.adjust()},update:function(){this.viewport.updateContentSize();this.viewport.adjust()},size:function(b,a){if(b==null||a==null)return this.viewport.getContentSize();this.viewport.setContentHeight(b);this.viewport.setContentWidth(a)},height:function(b){if(b==null)return this.viewport.getContentSize().height;
this.viewport.setContentHeight(b)},width:function(b){if(b==null)return this.viewport.getContentSize().width;this.viewport.setContentWidth(b)}})})(jQuery);